# Upstream - Downstream builds
The concept of upstream and downstream builds in Jenkins refers to the relationships between different jobs or pipelines, where one job triggers another based on certain conditions or dependencies. The need for upstream and downstream builds in Jenkins arises from several factors:

1. **Dependency Management**: In complex software development workflows, there are often dependencies between different components or stages of the build process. Upstream builds represent the components or stages that need to be built before downstream builds can proceed. This ensures that changes made to upstream components are propagated downstream in a controlled and orderly manner.

2. **Parallelization and Efficiency**: By organizing jobs into upstream and downstream builds, teams can parallelize the build process and improve efficiency. Upstream builds can trigger multiple downstream builds in parallel, allowing different parts of the system to be built concurrently. This reduces overall build times and enables faster feedback loops for developers.

3. **Modularization and Reusability**: Upstream and downstream builds encourage modularization and reusability of build components. Each job can focus on a specific task or functionality, making it easier to manage and maintain. Downstream builds can reuse artifacts (e.g., compiled binaries, test results) generated by upstream builds, reducing duplication of effort and ensuring consistency across the build process.

4. **Automation and Orchestration**: Jenkins provides powerful automation and orchestration capabilities for coordinating upstream and downstream builds. Jobs can be configured to trigger automatically based on predefined conditions (e.g., successful completion of upstream build, specific time of day). This streamlines the build process and reduces the need for manual intervention.

5. **Visibility and Traceability**: By establishing relationships between upstream and downstream builds, teams gain visibility into the entire build pipeline and can trace the flow of changes from development through testing to deployment. This enhances transparency and accountability, allowing teams to identify bottlenecks and optimize the build process for better performance and reliability.

Overall, upstream and downstream builds in Jenkins facilitate efficient, automated, and scalable software development workflows, enabling teams to manage dependencies, parallelize builds, promote modularity, and maintain visibility and traceability throughout the build process.

## Creating 4 Freestyle Jobs

We'll create a classic Jenkins job - using the freestyle type where you build up the steps using the web UI:

1. Create `freestyle-job-01`
- click _Create a job_ on the home screen
- call the new job `freestyle-job-01`
- set the job type to be _Freestyle project_
- click _OK_

We'll use this job to run a simple script which prints some text:

- scroll down to the _Build_ section
- click _Add build step_
- select _Execute shell_
- paste this into the _Command_ box:

```sh
#!/bin/bash
pwd
echo "Build script 01"
echo "Build ID: "$BUILD_ID
echo "Job Name: "$JOB_NAME
```
- click _Save_

2. Create `freestyle-job-02`

Browse back to Jenkins at http://localhost:8080/view/all/newJob to create a new job by copying the old `freestyle-job-01` job:

- call it `freestyle-job-02`

- select _Freestyle project_ as the job type

- In the _Copy from_ text box, enter `freestyle-job-01`

- click _OK_

Update the build steps. Scroll to the _Build Steps_ section:

- change the _Script_ to 
```sh
#!/bin/bash
pwd
echo "Build script 02"
echo "Build ID: "$BUILD_ID
echo "Job Name: "$JOB_NAME
```
- click _Save_

2. Create `freestyle-job-03`

Browse back to Jenkins at http://localhost:8080/view/all/newJob to create a new job by copying the old `freestyle-job-01` job:

- call it `freestyle-job-03`

- select _Freestyle project_ as the job type

- In the _Copy from_ text box, enter `freestyle-job-01`

- click _OK_

Update the build steps. Scroll to the _Build Steps_ section:

- change the _Script_ to 
```sh
#!/bin/bash
pwd
echo "Build script 03"
echo "Build ID: "$BUILD_ID
echo "Job Name: "$JOB_NAME
```
- click _Save_

2. Create `freestyle-job-04`

Browse back to Jenkins at http://localhost:8080/view/all/newJob to create a new job by copying the old `freestyle-job-01` job:

- call it `freestyle-job-04`

- select _Freestyle project_ as the job type

- In the _Copy from_ text box, enter `freestyle-job-01`

- click _OK_

Update the build steps. Scroll to the _Build Steps_ section:

- change the _Script_ to 
```sh
#!/bin/bash
pwd
echo "Build script 04"
echo "Build ID: "$BUILD_ID
echo "Job Name: "$JOB_NAME
```
- click _Save_

## Establish upstream/downstream relationship

1. Select your `freestyle-job-01`

- click the _Configure_ link in the left panel.

- click _Post-build Actions_ from the left panel

- click on _Add post-build action_ and select `Build other projects`

- enter `freestyle-job-02`

- click _Save_

1. Select your `freestyle-job-03`

- click the _Configure_ link in the left panel.

- click _Build Triggers_ from the left panel

- enable checkbox _Build after other projects are built_

- enter `freestyle-job-02`

- click _Save_

3. Select your `freestyle-job-04`

- click the _Configure_ link in the left panel.

- click _Build Triggers_ from the left panel

- enable checkbox _Build after other projects are built_

- enter `freestyle-job-02`

- click _Save_

4. Execute

- From the Jenkins Dashboard run the `freestyle-job-01`
- Watch the _Build Queue_ section in the left panel for observing the build sequence.
- Open each project and see the upstream/downstream information in the status

## Install plugin for better visualization

![](/imgs/yabv.png)

- open the Manage Jenkins Page http://localhost:8080/manage
- click _Plugins_ icon
- click on the _AVAILABLE_ tab
- search for _Yet Another Build Visualizer_
- select the _Yet Another Build Visualizer_ plugin for installation
- click _Install without restart_ button
- don't restart Jenkins, once the plugin is installed go back to dashboard http://localhost:8080/job/freestyle-job-01 for visualizing build flow
